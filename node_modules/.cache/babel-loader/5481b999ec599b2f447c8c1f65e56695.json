{"ast":null,"code":"import _objectSpread from \"/Users/JeHongHwang/Desktop/leekang/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nvar _jsxFileName = \"/Users/JeHongHwang/Desktop/leekang/src/components/service/singlecategory/SingleCategory.js\";\nimport React, { Component } from 'react';\nimport TipsForCategory from '../../layout/TipsForCategory';\nimport { connect } from 'react-redux';\nimport { Link } from 'react-router-dom';\nimport { compose } from 'redux';\nimport { firestoreConnect, isLoaded, isEmpty } from 'react-redux-firebase';\nimport Preloader from '../../functionalComponents/Preloader';\nimport ServicesSummary from '../summary/ServicesSummary';\nimport M from 'materialize-css';\nimport './singleCategory.css';\n\nclass SingleCategory extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      limit_list: 8,\n      moreServices: [],\n      nextRef: null,\n      loading: true\n    };\n\n    this.infiniteScroll = () => {\n      let scrollHeight = Math.max(document.documentElement.scrollHeight, document.body.scrollHeight);\n      let scrollTop = Math.max(document.documentElement.scrollTop, document.body.scrollTop);\n      let clientHeight = document.documentElement.clientHeight; // if(scrollTop + clientHeight === scrollHeight && !this.state.loading) {\n      //   console.log('all services are loaded!')\n      //   return;\n      // }\n\n      if (scrollTop + clientHeight === scrollHeight) {\n        this.loadMoreServices();\n      }\n    };\n\n    this.loadMoreServices = async () => {\n      const _this$props = this.props,\n            firestore = _this$props.firestore,\n            match = _this$props.match;\n      const _this$state = this.state,\n            limit_list = _this$state.limit_list,\n            nextRef = _this$state.nextRef;\n\n      if (!nextRef) {\n        const firstQuery = firestore.collection('testService').where(match.params.category, '>=', 1).orderBy(match.params.category, 'desc').limit(limit_list);\n        const firstSnaps = await firstQuery.get();\n        const firstVisible = firstSnaps.docs[firstSnaps.size - 1];\n        this.setState({\n          nextRef: firstVisible\n        });\n      }\n\n      try {\n        const nextQuery = firestore.collection('testService').where(match.params.category, '>=', 1).orderBy(match.params.category, 'desc').startAfter(this.state.nextRef).limit(limit_list);\n        const nextSnaps = await nextQuery.get();\n        const nextVisible = nextSnaps.docs[nextSnaps.size - 1];\n\n        if (!nextVisible) {\n          // when no more data in firestore\n          this.setState({\n            loading: false\n          });\n          return;\n        }\n\n        const loadedServices = nextSnaps.docs.map(doc => {\n          const id = doc.id;\n          const data = doc.data();\n          return _objectSpread({\n            id\n          }, data);\n        });\n        return this.setState({\n          moreServices: [...this.state.moreServices, ...loadedServices],\n          nextRef: nextVisible\n        });\n      } catch (err) {\n        console.log('error : ', err);\n      }\n    };\n  }\n\n  componentDidMount() {\n    window.addEventListener('scroll', this.infiniteScroll);\n    const carousels = document.querySelectorAll('.carousel');\n    M.AutoInit();\n    M.Carousel.init(carousels, {\n      dist: 0,\n      shift: 30,\n      padding: 30,\n      indicators: true\n    });\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('scroll', this.infiniteScroll);\n  }\n\n  componentWillReceiveProps(nextProps) {\n    // match the next changable props to state for initailizing\n    if (this.props.serviceList !== nextProps.serviceList) {\n      this.setState({\n        moreServices: nextProps.serviceList\n      });\n    }\n  }\n\n  render() {\n    const _this$props2 = this.props,\n          categoryIntro = _this$props2.categoryIntro,\n          serviceList = _this$props2.serviceList,\n          match = _this$props2.match;\n    const moreServices = this.state.moreServices;\n    return React.createElement(\"div\", {\n      className: \"container singleCategory\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108\n      },\n      __self: this\n    }, React.createElement(\"h4\", {\n      className: \"thema-title myomColor col s12 scorehvy\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109\n      },\n      __self: this\n    }, categoryIntro.title), React.createElement(\"p\", {\n      className: \"col s12 reference-content flow-text cartoon\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111\n      },\n      __self: this\n    }, React.createElement(\"i\", {\n      className: \"material-icons\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112\n      },\n      __self: this\n    }, \"format_quote\"), categoryIntro.content), React.createElement(\"div\", {\n      className: \"video-wrapper col s12 carousel\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117\n      },\n      __self: this\n    }, React.createElement(\"video\", {\n      style: {\n        width: '60%'\n      },\n      className: \"carousel-item\",\n      controls: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118\n      },\n      __self: this\n    }, React.createElement(\"source\", {\n      src: \"\",\n      type: \"video/mp4\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119\n      },\n      __self: this\n    })), React.createElement(\"video\", {\n      style: {\n        width: '60%'\n      },\n      className: \"carousel-item\",\n      controls: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123\n      },\n      __self: this\n    }, React.createElement(\"source\", {\n      src: \"\",\n      type: \"video/mp4\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124\n      },\n      __self: this\n    })), React.createElement(\"video\", {\n      style: {\n        width: '60%'\n      },\n      className: \"carousel-item\",\n      controls: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128\n      },\n      __self: this\n    }, React.createElement(\"source\", {\n      src: \"\",\n      type: \"video/mp4\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129\n      },\n      __self: this\n    }))), React.createElement(TipsForCategory, {\n      category: categoryIntro.title,\n      url: \"/community/user\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134\n      },\n      __self: this\n    }), React.createElement(\"ul\", {\n      className: \"row all_services_area\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136\n      },\n      __self: this\n    }, React.createElement(\"h5\", {\n      className: \"col s12 scorehvy\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137\n      },\n      __self: this\n    }, \"\\uC804\\uCCB4\"), !isLoaded(serviceList) ? React.createElement(Preloader, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140\n      },\n      __self: this\n    }) : isEmpty(moreServices) ? React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142\n      },\n      __self: this\n    }, \"\\uB4F1\\uB85D\\uB41C \\uC11C\\uBE44\\uC2A4\\uAC00 \\uC5C6\\uC2B5\\uB2C8\\uB2E4.\") : moreServices.map(item => {\n      return React.createElement(Link, {\n        to: `${match.url}/${item.id}`,\n        key: item.id,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 145\n        },\n        __self: this\n      }, React.createElement(ServicesSummary, {\n        service: item,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 146\n        },\n        __self: this\n      }));\n    }))));\n  }\n\n}\n\nconst mapStateToProps = (state, ownProps) => {\n  const category = ownProps.match.params.category;\n  return {\n    serviceList: state.firestore.ordered.testService,\n    categoryIntro: state.services[category]\n  };\n};\n\nexport default compose(firestoreConnect(props => [{\n  collection: 'testService',\n  where: [props.match.params.category, '>=', 1],\n  orderBy: [props.match.params.category, 'desc'],\n  limit: 8\n}]), connect(mapStateToProps))(SingleCategory);","map":{"version":3,"sources":["/Users/JeHongHwang/Desktop/leekang/src/components/service/singlecategory/SingleCategory.js"],"names":["React","Component","TipsForCategory","connect","Link","compose","firestoreConnect","isLoaded","isEmpty","Preloader","ServicesSummary","M","SingleCategory","state","limit_list","moreServices","nextRef","loading","infiniteScroll","scrollHeight","Math","max","document","documentElement","body","scrollTop","clientHeight","loadMoreServices","props","firestore","match","firstQuery","collection","where","params","category","orderBy","limit","firstSnaps","get","firstVisible","docs","size","setState","nextQuery","startAfter","nextSnaps","nextVisible","loadedServices","map","doc","id","data","err","console","log","componentDidMount","window","addEventListener","carousels","querySelectorAll","AutoInit","Carousel","init","dist","shift","padding","indicators","componentWillUnmount","removeEventListener","componentWillReceiveProps","nextProps","serviceList","render","categoryIntro","title","content","width","item","url","mapStateToProps","ownProps","ordered","testService","services"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport TipsForCategory from '../../layout/TipsForCategory';\nimport { connect } from 'react-redux';\nimport { Link } from 'react-router-dom';\nimport { compose } from 'redux';\nimport { firestoreConnect, isLoaded, isEmpty } from 'react-redux-firebase';\nimport Preloader from '../../functionalComponents/Preloader';\nimport ServicesSummary from '../summary/ServicesSummary';\nimport M from 'materialize-css';\nimport './singleCategory.css';\n\nclass SingleCategory extends Component {\n  state = {\n    limit_list : 8,\n    moreServices : [],\n    nextRef : null,\n    loading: true,\n  }\n\n  componentDidMount() {\n    window.addEventListener('scroll', this.infiniteScroll);\n\n    const carousels = document.querySelectorAll('.carousel');\n    M.AutoInit();\n    M.Carousel.init(carousels, {\n      dist: 0,\n      shift: 30,\n      padding: 30,\n      indicators: true,\n    })\n  }\n  componentWillUnmount() {\n    window.removeEventListener('scroll', this.infiniteScroll);\n  }\n\n  componentWillReceiveProps(nextProps) {  // match the next changable props to state for initailizing\n    if(this.props.serviceList !== nextProps.serviceList) {\n      this.setState({\n        moreServices: nextProps.serviceList,\n      })\n    }\n  }\n\n  infiniteScroll = () => {\n    let scrollHeight = Math.max(document.documentElement.scrollHeight, document.body.scrollHeight);\n    let scrollTop = Math.max(document.documentElement.scrollTop, document.body.scrollTop);\n    let clientHeight = document.documentElement.clientHeight;\n\n    // if(scrollTop + clientHeight === scrollHeight && !this.state.loading) {\n    //   console.log('all services are loaded!')\n    //   return;\n    // }\n\n    if(scrollTop + clientHeight === scrollHeight) {\n      this.loadMoreServices();\n    }\n  }\n\n  loadMoreServices = async () => {\n    const { firestore, match } = this.props;\n    const { limit_list, nextRef } = this.state;\n\n    if(!nextRef) {\n      const firstQuery = firestore.collection('testService')\n        .where(match.params.category, '>=', 1).orderBy(match.params.category, 'desc').limit(limit_list);\n      const firstSnaps = await firstQuery.get();\n      const firstVisible = firstSnaps.docs[firstSnaps.size - 1];\n      \n      this.setState({\n        nextRef: firstVisible,\n      })\n    }\n    \n    try {\n      const nextQuery = firestore.collection('testService')\n        .where(match.params.category, '>=', 1).orderBy(match.params.category, 'desc').startAfter(this.state.nextRef).limit(limit_list);\n      const nextSnaps = await nextQuery.get();\n      const nextVisible = nextSnaps.docs[nextSnaps.size - 1]\n      \n      if(!nextVisible) {  // when no more data in firestore\n        this.setState({\n          loading: false,\n        })\n        return;  \n      }\n\n      const loadedServices = nextSnaps.docs.map(doc => {\n        const id = doc.id;\n        const data = doc.data();\n        return { id, ...data }\n      })\n\n      return this.setState({\n        moreServices : [...this.state.moreServices, ...loadedServices],\n        nextRef : nextVisible,\n      })\n    } catch(err) {\n      console.log('error : ', err);\n    }   \n  }\n\n  render() {\n    const { categoryIntro, serviceList, match } = this.props;\n    const { moreServices } = this.state;\n\n    return (\n      <div className=\"container singleCategory\">\n        <div className=\"row\">\n          <h4 className='thema-title myomColor col s12 scorehvy'>{categoryIntro.title}</h4>\n  \n          <p className=\"col s12 reference-content flow-text cartoon\">\n            <i className=\"material-icons\">format_quote</i>\n            {categoryIntro.content}\n          </p>\n\n          \n          <div className=\"video-wrapper col s12 carousel\">\n            <video style={{width: '60%'}} className='carousel-item' controls>\n              <source src='' type='video/mp4'/>\n              {/* https://firebasestorage.googleapis.com/v0/b/myom-89a5a.appspot.com/o/videos%2Freferences%2Fcinema%2F190913%2BMYOM%2B%EC%97%AC%ED%96%89%2B%EC%98%81%EC%83%81%2B%ED%8E%B8%EC%A7%91%2B%ED%94%8C%EB%9E%AB%ED%8F%BC.mp4?alt=media&token=cb4e2cdb-df78-4682-9712-46715da9d899 */}\n            </video>\n\n            <video style={{width: '60%'}} className='carousel-item' controls>\n              <source src='' type='video/mp4'/>\n              {/* https://firebasestorage.googleapis.com/v0/b/myom-89a5a.appspot.com/o/videos%2Freferences%2Fcinema%2F190825%2B%E1%84%8F%E1%85%AF%E1%86%AB%E1%84%90%E1%85%B3%2B%E1%84%8B%E1%85%A7%E1%86%BC%E1%84%89%E1%85%A1%E1%86%BC.mp4?alt=media&token=04f3824f-1404-4b5a-9e9f-fa702b965de8 */}\n            </video>\n\n            <video style={{width: '60%'}} className='carousel-item' controls>\n              <source src='' type='video/mp4'/>\n              {/* https://firebasestorage.googleapis.com/v0/b/myom-89a5a.appspot.com/o/videos%2Freferences%2Fcinema%2FKakaoTalk_Video_20190927_2317_22_548.mp4?alt=media&token=dca0990d-1fa2-4805-a7d0-90b858dfbc2e */}\n            </video>\n          </div>\n\n          <TipsForCategory category={categoryIntro.title} url='/community/user'/>\n\n          <ul className=\"row all_services_area\">\n            <h5 className='col s12 scorehvy'>전체</h5>\n            {\n              !isLoaded(serviceList)\n                ? <Preloader />\n                : isEmpty(moreServices)\n                  ? <div>등록된 서비스가 없습니다.</div>\n                  : moreServices.map(item => {\n                    return (\n                      <Link to={`${match.url}/${item.id}`} key={item.id}>\n                        <ServicesSummary service={item} />\n                      </Link>\n                    )\n                  })\n            }\n            {/* {\n              (loading)\n                ? <button onClick={() => this.loadMoreServices()} className=\"waves-effect waves-teal right btn-flat\">더 보기...</button>\n                : null\n            } */}\n          </ul>\n\n        </div>\n        \n        \n        {/* <ul className=\"collection row\">\n          <h4>최다 평점 획득</h4>\n          <div className=\"col s4\">\n            <div className=\"card\">\n              <div className=\"card-image\">\n                <img className='' src='' alt=\"\"/>\n                <span className=\"card-title black\">최다 평점 1</span>\n              </div>\n            </div>  \n          </div>\n        </ul>\n\n       <ul className=\"collection row\">\n        <h4>최다 작업 수행</h4>\n          <div className=\"col s4\">\n            <div className=\"card\">\n              <div className=\"card-image\">\n                <img className='' src='' alt=\"\"/>\n                <span className=\"card-title black\">최다 작업 1</span>\n              </div>\n            </div>  \n          </div>\n       </ul>\n\n        <ul className=\"collection row\">\n          <h4>최고 빠른 작업</h4>\n          <div className=\"col s4\">\n            <div className=\"card\">\n              <div className=\"card-image\">\n                <img className='' src='' alt=\"\"/>\n                <span className=\"card-title black\">최고 빠른 1</span>\n              </div>\n            </div>  \n          </div>   \n        </ul> */}\n\n        \n      </div>\n    )\n  }\n}\nconst mapStateToProps = (state, ownProps) => {\n  const category = ownProps.match.params.category;\n  return {\n    serviceList: state.firestore.ordered.testService,\n    categoryIntro: state.services[category],\n  }\n}\nexport default compose(\n  firestoreConnect((props) => [\n    { collection: 'testService', where: [props.match.params.category, '>=', 1], orderBy: [props.match.params.category, 'desc'], limit: 8 }\n  ]),\n  connect(mapStateToProps)\n)(SingleCategory);"]},"metadata":{},"sourceType":"module"}